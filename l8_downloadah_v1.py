'''   URLRetrieve for the L8 on AWS


        This simple script iterates through the
        available data.  It places the files in the 
		same directory from which it is invoked.
        2015-03-23
        
       Daryl Van Dyke
       Klamath Strategic Habitat Conservation Team
       GIS Analyst
       daryl_van_dyke@fws.gov
       
'''
import urllib2,os, wget, urllib

#  CHANGE ME for output somewhere other than where the script is called

strOutputDir = ""  # make sure the path ends in /


urlStart = r"https://s3-us-west-2.amazonaws.com/landsat-pds/L8/142/210/LT81422102015015LGN00/"
urlTest =  r"https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/032/LC80440322014253LGN00/index.html"

listURL = ["https://s3-us-west-2.amazonaws.com/landsat-pds/L8/047/031/LC80470312015053LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/045/030/LC80450302014276LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/032/LC80440322014253LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/045/032/LC80450322014276LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/045/031/LC80450312014276LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/045/033/LC80450332014276LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/045/033/LC80450332015055LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/031/LC80440312014253LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/045/033/LC80450332015007LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/045/030/LC80450302015055LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/033/LC80440332014253LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/032/LC80440322014301LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/047/031/LC80470312014274LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/045/032/LC80450322015055LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/031/LC80440312014285LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/045/031/LC80450312015055LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/031/LC80440312015048LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/033/LC80440332014301LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/030/LC80440302014253LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/030/LC80440302015048LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/033/LC80440332015064LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/032/LC80440322015064LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/034/LC80440342014301LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/034/LC80440342014365LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/034/LC80440342015064LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/033/LC80440332014365LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/031/LC80440312015064LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/045/032/LC80450322015007LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/033/LC80440332015080LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/046/032/LC80460322015046LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/032/LC80440322015080LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/045/033/LC80450332015023LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/045/032/LC80450322015023LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/045/033/LC80450332014308LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/045/031/LC80450312014228LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/031/LC80440312014301LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/046/033/LC80460332014299LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/030/LC80440302014285LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/045/031/LC80450312015007LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/045/030/LC80450302015007LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/046/031/LC80460312014235LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/032/LC80440322015048LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/046/033/LC80460332015078LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/047/031/LC80470312015021LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/047/031/LC80470312014130LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/045/031/LC80450312015071LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/045/031/LC80450312014292LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/045/030/LC80450302015071LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/046/031/LC80460312015030LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/030/LC80440302014365LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/030/LC80440302015064LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/032/LC80440322014365LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/045/031/LC80450312015023LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/034/LC80440342014269LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/034/LC80440342015080LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/045/032/LC80450322014292LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/046/032/LC80460322015078LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/047/031/LC80470312014306LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/046/033/LC80460332015046LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/045/032/LC80450322014356LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/031/LC80440312015080LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/046/032/LC80460322014219LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/030/LC80440302014301LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/046/032/LC80460322014299LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/046/032/LO80460322015062LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/031/LC80440312014365LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/033/LC80440332014269LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/045/032/LC80450322015071LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/030/LC80440302014333LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/046/031/LC80460312015046LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/046/032/LC80460322015030LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/046/033/LO80460332015062LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/034/LC80440342014253LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/046/032/LC80460322015014LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/046/032/LC80460322014347LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/046/031/LC80460312014347LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/046/031/LC80460312015078LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/045/031/LC80450312014260LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/030/LC80440302015016LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/046/032/LC80460322014235LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/045/032/LC80450322014308LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/033/LC80440332015048LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/034/LC80440342015032LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/046/031/LC80460312014251LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/045/033/LC80450332014292LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/046/033/LC80460332015014LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/046/033/LC80460332014155LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/046/031/LC80460312015014LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/046/031/LC80460312014283LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/045/033/LC80450332014356LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/045/033/LC80450332014340LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/046/033/LC80460332015030LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/046/031/LC80460312014315LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/046/032/LC80460322014363LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/046/033/LC80460332014347LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/045/030/LC80450302015023LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/045/033/LC80450332015071LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/047/031/LC80470312015069LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/030/LC80440302015080LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/033/LC80440332015032LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/047/031/LC80470312015037LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/045/032/LC80450322015039LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/046/031/LO80460312015062LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/045/033/LC80450332015039LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/047/031/LC80470312015005LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/031/LC80440312015016LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/034/LC80440342015016LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/032/LC80440322015032LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/045/031/LC80450312015039LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/032/LC80440322015016LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/033/LC80440332015016LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/034/LC80440342015048LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/031/LC80440312015032LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/044/030/LC80440302015032LGN00/index.html","https://s3-us-west-2.amazonaws.com/landsat-pds/L8/045/030/LC80450302015039LGN00/index.html"]


def lister(inputURL):
    return  os.path.split(inputURL)

listFolders = [ ]  #

def StringExtractor(inputString,wrapperString = '''"'''):
    k = inputString.find(wrapperString)
    l = inputString[k+1:].find(wrapperString)
    finalString = inputString[k+1:k+l+1]
    return finalString


###################################################################################
def L8_AWS_Downloadah(inputURLString_to_index):
    path = os.path.split(inputURLString_to_index)[0]
    print path
    l8Site = urllib2.Request(inputURLString_to_index)
    response = urllib2.urlopen(l8Site)
    thisPage = response.read()
    #print thisPage
    list1 = thisPage.split('\n')
    list2 = []
    for items in list1:
        if "<a href=" in items:
            #print items
            string2 = StringExtractor(items)
            #print string2
            list2.append(path+"/"+string2)
    for items in list2:
        print "--->",items
        filename = wget.download(items)
        #urllib.urlretrieve(items, items)
    del l8Site,response,thisPage,list1,list2,filename

L8_AWS_Downloadah(listURL[0])
